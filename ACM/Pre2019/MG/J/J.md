# J

扫描线。

将所有x方向的边按y坐标排序，从下往上扫一遍，用维护当前有效边的并的有效长度。如果一条边是下底就加入边集，是上底就从边集中减去。答案是每一次得到的有效边长度乘以对应y坐标差的累加。

如何用线段树维护有效长度呢？在线段树里记录每一个区间目前有多少条线段覆盖。有线段覆盖说明区间内有效长度就是区间长度，没有的话则为左区间和右区间的有效长度之和。