# K

这道题是后缀自动机parent树的应用。我们知道每个点的right集合都包含了几个长度连续共同结尾的串，其大小为子树中有多少个原串的前缀。那么沿着parent树dfs就可以先求出来每个点的right集合大小，再拿每个点的right集合去更新对应长度的最大值$cnt[len[x]]$。最后，由于right集合可能不只有一个串，可以沿着长度递减的顺序，即用$cnt[i]$更新$cnt[i-1]$