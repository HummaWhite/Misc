# F

看了题解之后做的。就谈一下我理解的题意转换过程吧。

以S = eabcacbac，T = baecca为例

首先，S的一个子串能和T的一个前缀拼成一个回文串且子串比前缀长，那么子串反过来，也就是S串反过来cabcacbae的子串与T有公共前缀。假设找到了一个公共前缀bae，观察到其在S反串中相邻的左端点c属于回文串cac，得到串cacbae。发现cacbae反转回去刚好能和bae拼成回文串。所以要求总数，我们要找到所有的公共前缀和每个位置所属的回文串。题目是计数，那就要求S反串每个后缀与T的公共前缀的数量，和每个S每一个位置被多少个回文串覆盖。

对于前者，exkmp。而对于找一个位置被多少个回文串覆盖的问题，可以对S建回文自动机，在建立的时候统计一下每个位置对应节点有多少个祖先节点。