# D

Awsl，肝了31发WA发现写了个假算法，对拍没有查出来（不过数据也不太好造），重写一遍玄学过了。

这道题的主要思想：因为m比n大不了多少且不超过30，图的形态接近一棵树，可以看成树上添了不到30条边。这样，图上两点间的最短路可以分为完全树上的和经过多出来的边的两类。经过多出来的边这一类实际上是经过多出来边上的点，由于数量很少，可以预处理从每一条剩下的边上一个点开始的最短路$dis[i, x]$，然后比较树上的长度和$dis[i, u] + dis[i, v]$即可。树上路径长度链剖/LCA。

复杂度专题题解中已给出。