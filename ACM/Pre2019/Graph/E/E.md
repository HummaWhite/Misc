# E

注意到在出入某点时，当前的颜色一定来自于这个点连的边的颜色。而每次对下一步要走的边枚举颜色的朴素做法考虑了很多不存在的情况。所以考虑加一些点达到这个限制条件。对于题解的做法，我理解为在每个点的周围连一圈“颜色点”，表示相邻的边有哪些颜色，然后相邻的点通过相同颜色的“颜色点”连接而不是直接连接，这样就排除了需要大量枚举的无效状态。然后设置边权，一个点到相邻的“颜色点”之间的边权为1，同种颜色的“颜色点”之间为0。最后跑一遍最短路，答案/2。