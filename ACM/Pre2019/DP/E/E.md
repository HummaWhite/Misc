# E

由于每一块中元素可以随意重排，结果只和每一块有哪些元素、前一块和后一块是否能有相接部分有关，而与每块每种元素有多少没有关系。因此我们只需记录没块有那些元素就行了。考虑状态$dp[i][j]$表示处理到第$i$块，而上一块的末尾为$j$（这个$j$要么状压要么预先处理在数组里面，$k$同理）时的最小段数。通过枚举当前块的末尾$k$，我们可以得到以下转移方程：当此块元素多于一个时：$dp[i, k] = \min(dp[i, k], dp[i-1, j] + (k == j ? cnt[i]-1: cnt[i]))$；只有一个时就判断一下和前块末尾一不一样。