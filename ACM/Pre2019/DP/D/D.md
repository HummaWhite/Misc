# D

正着求一遍LIS，倒着求一遍LIS，就得到了每个数为终点的左右两个方向的LIS。每个点为中心的最长序列的长度即两边LIS取min再乘2减1。最后扫一遍取max就好了。n <= 1e6，树状数组优化。