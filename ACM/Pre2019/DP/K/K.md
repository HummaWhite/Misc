# K

$dp[i][j]$表示抽$i$次，抽到$j$个碎片的概率，令$j$最大为$m-1$的话，$\sum{dp[n][j]}$就是没有抽到的概率。这样答案就是$1-\sum{dp[n][j]}$。

观察转移方程：

$dp[i][j] = (1-x-(m-j)y)dp[i-1][j]+(m-j+1)y*dp[i-1][j-1]+......$（懒得打了）

把$dp[i]$和$dp[i-1]$分开列出来，发现是乘了一个矩阵。

这个矩阵是（不知道写对没有）
$$
\left\{
\begin{matrix}
1-x-my & 0 & 0 &&&&& ... &&&&&& 0\\
my & 1-x-(m-1)y & 0 &&&&& ... &&&&&& 0\\
0 & (m-1)y & 1-x-(m-2)y \\
... \\ \\ 
&&&&&&&&&&&&1-y\\
0 & ... &&&&&&&&&&&y&1-x
\end{matrix}
\right\} \tag{2}
$$
然后就可以矩阵快速幂转移了